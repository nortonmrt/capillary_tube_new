![image](https://user-images.githubusercontent.com/108631583/205446708-01bdb6ce-a76e-47a3-ad26-2e4e9b1ee092.png)

# Refrigeration tools
Simple routines to get valuable information for the project of refrigeration systems. There are two main codes, one for determining an estimated length of a capillary tube, and the other one to determine the evaporating and condensing temperatures, given the requirements of the system. Both are detailed below.

## Capillary tube (main)
This routine estimate the length of a capillary tube, for a refrigeration system using R-290 (propane). The input data is:
- Mass flow rate of refrigerant (kg/s);
- Evaporation/condensing pressure (bar);

There are four common capillary diameters already implemented (units in inches). More diameteres can be added by the user, if necessary. The routine evaluate each one of the diameters, getting the smaller one for which the system works properly.
``` 
d = np.array([0.036, 0.047, 0.055, 0.063]) #in
``` 
The temperature and thermodynamical properties are given by polynomial curves, generated by Fabio Fortkamp (2022). These curves are only valid for R290, but the coefficients can be changed for the oned of another refrigerant.
```
v_l = 0.005975 - 3.916E-5*T + 8.702E-8*T**2 #m³/kg
v_v = -0.01095 + 0.001874*(T/P) + 0.00000000124*(T/P)**2 #m³/kg
h_l = 1046 - 8.766*T + 0.01926*T**2 #kJ/kg
h_v = 1060-10.38*T + 0.04771*T**2 - 0.0000644*T**3 #kJ/kg
mu_l = 1073 - 5.569*T + 0.007689*T**2 #uPas
mu_v = 7.732 - 0.03368*T + 0.0001194*T**2 #uPas
```
The mathematical model won't be detailed here, but can be consulted in "Refrigeration and Air Conditioning" by Stoecker and Jones (McGraw-Hill, 1985), in the chapter of expansion devices. The main idea is to divide the tube in small sections and evaluate the quality each one, based on the saturated thermodynamical properties and mass flow. With the quality factor it is possible to obtain the properties in that section and calculate the friction factor. The conservation of mass and momentum allows the obtaining of an expression for the length of the section of the tube, as shown above:
```
delta_L[0,i+1] = (d[j]*2*v[0,i+1]/(f[0,i+1]*Vm[0,i+1]**2))*((P[i] - P[i+1])*10**5 - m_dot*(V[0,i+1] - V[0,i])/Area[j])
```
Adding all the lengths, it is possible to obtain the total length of the tube. It is important to notice that the theory assumes an adiabatic tube.

It is possible that the length of the section becomes negative (case in which the flow becomes supersonic). In this case, as the cross section of the tube is constant, the velocity only increases for a negative entropy, which is impossible. In case that happens, the routine select the next higher tube diameter and recalculate everything.

## Equilibrium of the condensing and evaporation temperatures (main_temperatures)
In this case, the mass flow rate of refrigerant, the condensing and evaporating temperatures and the thermal conductance of the heat exchangers are obtained. The code is written as the project requirement is the heat rejected by the condenser (heat pump), but in further versions it will be possible to have the heat absorbed bu the evaporator as a requirement. The input data is:
- An estimative of the condensing temperature (in oC)
- The heat rejected by the condenser (in W)
- An estimative of the thermal conductance of the evaporator (in W/K)
- The ambient temperatures (in oC)

Another entry data is the compressor curves for absorbed heat and consumption, generated for a specific compressor (in this case an Embraco ESX55C). If necessary, these data can be changed, in case of other compressor model:
```
t_cond = np.array([35,35,35,35,35,35,45,45,45,45,45,45,55,55,55,55,55]) #oC
t_evap = np.array([-35,-30,-25,-20,-15,-10,-35,-30,-25,-20,-15,-10,-30,-25,-20,-15,-10]) #oC
Q_L = np.array([98,131,171,218,274,338,89,122,161,207,263,327,112,150,196,250,314]) #W
W_comp = np.array([63,72,82,91,100,109,64,75,86,98,111,123,75,89,103,118,134]) #W
```
Based on the data above, the curves were generated using the curve_fit function:
```
# Objective functions
def capacity(x_data, w0, w1, w2, w3, w4, w5):
    return w0 + w1*x_data[1] + w2*x_data[0] + w3*x_data[1]**2 + w4*x_data[1]*x_data[0] + w5*x_data[0]**2

def consumption(x_data, u0, u1, u2, u3, u4, u5):
    return u0 + u1*x_data[1] + u2*x_data[0] + u3*x_data[1]**2 + u4*x_data[1]*x_data[0] + u5*x_data[0]**2

w, _ = curve_fit(capacity, x_data, Q_L)
u, _ = curve_fit(consumption, x_data, W_comp)
```
The function ```compressor_curve``` performs this operation. With all this information, the evaporating and condensing temperature polynomials can be evaluated, and with a recursive procedure it is possible to obtain the equilibrium temperatures. This functionality was implemented in the ```Eq_temps``` function.

Finally, as the other properties couldn't be obtained by the current information, the CoolProp library was used to determine the other properties and evaluate the mass flow rate of refrigerant:
```
m_dot = Q_H/(h2 - h3)
```
The information obtained by this routine can even be evaluated in the previous one, to determine the length of the capillary tube. In future versions both functionalities will be implemented in a single routine.







